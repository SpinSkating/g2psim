      subroutine carbon(EI, ANG, XS)

      IMPLICIT DOUBLE PRECISION (A-H,O-Z)

      INCLUDE 'ravpro.inc'

      PARAMETER (NPMX=29)
      PARAMETER (NPMXP1=NPMX+1)
      PARAMETER (NPTSMX=1)
      
      INTEGER NPRINT(10), NPUNCH(5)

      DOUBLE PRECISION PAR(NPMXP1),PARAM(NPMX)
      DOUBLE PRECISION ST(NPTSMX)
      DOUBLE PRECISION THX(NPTSMX),RHO(NPTSMX),RHOERR(NPTSMX)
      DOUBLE PRECISION FRN(NFMX),GRN(NFMX),FIN(NFMX),GIN(NFMX) 
      DOUBLE PRECISIOn DELTH(NPTSMX),DELPH(NPTSMX),XMS(NPTSMX)

      COMMON /CHARGE/ MODELN,PARAM
      COMMON /IO/ NPRINT,NPUNCH
      COMMON /COUL/ FRN,GRN,FIN,GIN
      COMMON /CONST/ XMN,HBARC,ALPHA,XME,PI,DTR,RAD

      Z=6.0D0
      A=12.0D0
      MODELN=18
      CONV=1.0D-17
      STEP=1.0D-2
      NFL=0
      IF (CONV.LE.0.D0) CONV=1.0D-6
      IF (STEP.LE.0.D0) STEP=5.0D-2
      IF (NFL.LE.0) NFL=50
      RSQR=1.2D0*A**.33333333D0

      DO 100 I=1,10
          NPRINT(I)=0
 100  CONTINUE

      DO 101 I=1,5
          NPUNCH(I)=0
 101  CONTINUE

      CALL CHGDE3 (RHONA,NPARM1)
      NPAR=NPARM1+1
      NPARP1=NPAR+1
      NPARP2=NPARP1+1
      PAR(1)=1.97540168D-01
      PAR(2)=8.00000000D+00
      PAR(3)=2.46366257D+00
      PAR(4)=2.34129936D+00
      PAR(5)=9.33217914D-01
      PAR(6)=-2.75281247D-01
      PAR(7)=-6.21780640D-01
      PAR(8)=-4.38311011D-01
      PAR(9)=-1.75758450D-01
      PAR(10)=-4.04346893D-02
      PAR(11)=4.56762854D-03
      PAR(12)=1.17304566D-02
      PAR(13)=4.77479503D-03
      PAR(14)=3.24841548D-03
      PAR(15)=9.10117298D-04
      PAR(16)=1.47384040D-04
      PAR(17)=4.35492803D-05
      PAR(18)=4.40113536D-05
      PAR(19)=3.93213328D-06
      PAR(20)=1.0D0
      DO 200 I=1,NPAR
          PARAM(I)=PAR(I)
 200  CONTINUE

      EX=EI
      NF=0
      X0=0.0D0
      OTEST=0.0D0
      GNRM=-1.0D0

      IF (EX.NE.0.0D0) THEN
          IF (X0.LE.0.0D0) X0=3.0D0*RSQR*EX/HBARC
          X0=STEP*INT(X0/STEP)
          IF (NF.LE.0) NF=1.0D0+3.0D0*X0
          NF=MIN(NF,NFMX-1)
          IF ((OTEST.LE.0.0D0).AND.(2.0D0*EX*RSQR.LE.HBARC)) 
     1    OTEST=180.0D0
          IF (OTEST.LE.0.0D0) OTEST=2.0D0*RTD*DASIN(HBARC/
     1    (2.0D0*EX*RSQR))
      ENDIF

      GAM=Z*ALPHA
      CALL COULS (GAM,X0,NF)

      THX(1)=ANG
      DELTH(1)=0.0D0
      DELPH(1)=0.0D0
      XMS(1)=0.0D0

      CALL RAVPRO (GAM,EX,EXCM,A,CONV,X0,STEP,OTEST,THX,RHO
     1 ST,RHOERR,1,NF,NFL,DELTH,DELPH,XMS,0,RMS)

      XS=ST(1)

      return
      
      end
